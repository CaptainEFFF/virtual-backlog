// var games= require(db)
// replace with reference to database.
var books = [
{Title : "Borderlands",
System_type: "PS4",
Year_released: 2012,
is_Physical: true,
is_beaten: true,
personal_rating: 10,
notes:"this game is great",
api_url:"",
giant_bomb_ID:"",
box_art:"",
description:"This is a Game about Shooting Guns and Looting Loot"
},
{Title : "Bioshock",
System_type: "PS4",
Year_released: 2012,
is_Physical: true,
is_beaten: true,
personal_rating: 10,
notes:"",
api_url:"",
giant_bomb_ID:"",
box_art:"",
description:""
},
{Title : "The Legend of Zelda",
System_type: "PS4",
Year_released: 2012,
is_Physical: true,
is_beaten: true,
personal_rating: 10,
notes:"",
api_url:"",
giant_bomb_ID:"",
box_art:"",
description:""
},
{Title : "Sonic Adventure",
System_type: "PS4",
Year_released: 2012,
is_Physical: true,
is_beaten: true,
personal_rating: 10,
notes:"",
api_url:"",
giant_bomb_ID:"",
box_art:"",
description:""
},
{Title : "Super Mario Bros.",
System_type: "PS4",
Year_released: 2012,
is_Physical: true,
is_beaten: true,
personal_rating: 10,
notes:"",
api_url:"",
giant_bomb_ID:"",
box_art:"",
description:""
},
{Title : "Minecraft",
System_type: "PS4",
Year_released: 2012,
is_Physical: true,
is_beaten: true,
personal_rating: 10,
notes:"",
api_url:"",
giant_bomb_ID:"",
box_art:"",
description:""
},
{Title : "Dark Souls",
System_type: "PS4",
Year_released: 2012,
is_Physical: true,
is_beaten: true,
personal_rating: 10,
notes:"",
api_url:"",
giant_bomb_ID:"",
box_art:"",
description:""
},
{Title : "Halo",
System_type: "PS4",
Year_released: 2012,
is_Physical: true,
is_beaten: true,
personal_rating: 10,
notes:"",
api_url:"",
giant_bomb_ID:"",
box_art:"",
description:""
},
{Title : "Skyrim",
System_type: "PS4",
Year_released: 2012,
is_Physical: true,
is_beaten: true,
personal_rating: 10,
notes:"",
api_url:"",
giant_bomb_ID:"",
box_art:"",
description:""
},
{Title : "Borderlands",
System_type: "PS4",
Year_released: 2012,
is_Physical: true,
is_beaten: true,
personal_rating: 10,
notes:"",
api_url:"",
giant_bomb_ID:"",
box_art:"",
description:""
},
{Title : "Bioshock",
System_type: "PS4",
Year_released: 2012,
is_Physical: true,
is_beaten: true,
personal_rating: 10,
notes:"",
api_url:"",
giant_bomb_ID:"",
box_art:"",
description:""
},
{Title : "The Legend of Zelda",
System_type: "PS4",
Year_released: 2012,
is_Physical: true,
is_beaten: true,
personal_rating: 10,
notes:"",
api_url:"",
giant_bomb_ID:"",
box_art:"",
description:""
},
{Title : "Sonic Adventure",
System_type: "PS4",
Year_released: 2012,
is_Physical: true,
is_beaten: true,
personal_rating: 10,
notes:"",
api_url:"",
giant_bomb_ID:"",
box_art:"",
description:""
},
{Title : "Super Mario Bros.",
System_type: "PS4",
Year_released: 2012,
is_Physical: true,
is_beaten: true,
personal_rating: 10,
notes:"",
api_url:"",
giant_bomb_ID:"",
box_art:"",
description:""
},
{Title : "Minecraft",
System_type: "PS4",
Year_released: 2012,
is_Physical: true,
is_beaten: true,
personal_rating: 10,
notes:"",
api_url:"",
giant_bomb_ID:"",
box_art:"",
description:""
},
{Title : "Dark Souls",
System_type: "PS4",
Year_released: 2012,
is_Physical: true,
is_beaten: true,
personal_rating: 10,
notes:"",
api_url:"",
giant_bomb_ID:"",
box_art:"",
description:""
},
{Title : "Halo",
System_type: "PS4",
Year_released: 2012,
is_Physical: true,
is_beaten: true,
personal_rating: 10,
notes:"",
api_url:"",
giant_bomb_ID:"",
box_art:"",
description:""
},
{Title : "Skyrim",
System_type: "PS4",
Year_released: 2012,
is_Physical: true,
is_beaten: true,
personal_rating: 10,
notes:"",
api_url:"",
giant_bomb_ID:"",
box_art:"",
description:""
},
{Title : "Borderlands",
System_type: "PS4",
Year_released: 2012,
is_Physical: true,
is_beaten: true,
personal_rating: 10,
notes:"",
api_url:"",
giant_bomb_ID:"",
box_art:"",
description:""
},
{Title : "Bioshock",
System_type: "PS4",
Year_released: 2012,
is_Physical: true,
is_beaten: true,
personal_rating: 10,
notes:"",
api_url:"",
giant_bomb_ID:"",
box_art:"",
description:""
},
{Title : "The Legend of Zelda",
System_type: "PS4",
Year_released: 2012,
is_Physical: true,
is_beaten: true,
personal_rating: 10,
notes:"",
api_url:"",
giant_bomb_ID:"",
box_art:"",
description:""
},
{Title : "Sonic Adventure",
System_type: "PS4",
Year_released: 2012,
is_Physical: true,
is_beaten: true,
personal_rating: 10,
notes:"",
api_url:"",
giant_bomb_ID:"",
box_art:"",
description:""
},
{Title : "Super Mario Bros.",
System_type: "PS4",
Year_released: 2012,
is_Physical: true,
is_beaten: true,
personal_rating: 10,
notes:"",
api_url:"",
giant_bomb_ID:"",
box_art:"",
description:""
},
{Title : "Minecraft",
System_type: "PS4",
Year_released: 2012,
is_Physical: true,
is_beaten: true,
personal_rating: 10,
notes:"",
api_url:"",
giant_bomb_ID:"",
box_art:"",
description:""
},
{Title : "Dark Souls",
System_type: "PS4",
Year_released: 2012,
is_Physical: true,
is_beaten: true,
personal_rating: 10,
notes:"",
api_url:"",
giant_bomb_ID:"",
box_art:"",
description:""
},
{Title : "Halo",
System_type: "PS4",
Year_released: 2012,
is_Physical: true,
is_beaten: true,
personal_rating: 10,
notes:"",
api_url:"",
giant_bomb_ID:"",
box_art:"",
description:""
},
]
var games;
$( document ).ready(function() {
   $.ajax({
      url: "/api/games",
      type: 'GET',
      success: function (res) {
  
         games = res;
        console.log(res);
        creategame();
      }
    });
});
  
         

var game;
var front;
var cover;
var page;
var back;
var right;
var left;
var topa;
var bottom;
var counter;

function creategame(){
game;
front;
cover;
page;
back;
right;
left;
topa;
bottom;
counter = 0;


for (var i = 0; i < games.length; i++){
    game = $('<li class ="' + i + '"> <div class="bk-game game' + i + '"></div></li>' )
    $("#bk-list").append(game);

    front = $(`<div class="bk-front"></div>`)
    
    $(front).append(`<div class="bk-cover-back"></div>`);
    
    cover = $(`<div class="bk-cover" style = "background: url(`+games[i].box_art+`)" >`)
    $(cover).append('<h2> <span>' + games[i].title + '</span><span>'+ games[i].system_type +'</span></h2></div></div>');
    $(front).append(cover);
    
    page = $(`<div class="bk-page">`)
    $(page).append('<div class="bk-content bk-content-current" style = "background: url ('+games[i].box_art +')"></div>')
    $(page).append('<div class="bk-content"><p>' + games[i].description + '</p></div>')
    $(page).append('<div class="bk-content "><p>Physical Copy: ' + games[i].is_Physical + "</p><p> Beat the Game? " + games[i].is_beaten + "</p><p>Personal Rating: " + games[i].personal_rating + '/10 </p></div>')
    $(page).append('<div class="bk-content "><p>' + games[i].notes + '</p></div></div>')
    
    back = $(`<div class="bk-back">`)
    $(back).append('<p>' + games[i].title + "</p><p> " + games[i].description +"</p><p> "+ games[i].giant_bomb_ID + '</p></div>')

    right = (`<div class="bk-right"></div>`);
    left = (`<div class="bk-left"><h2><span>` + games[i].title + '  </span><span>'+ games[i].system_type +`</span></h2>`);
    topa = (`<div class="bk-top"></div>`);
    bottom = (`<div class="bk-bottom"></div>`);

    $(".game"+i).append(front,page,back,right,left,topa,bottom);
   counter ++;
   if (counter === 13){
    $("#bk-list").append("<div class=shelf></div>");
       counter = 0;
   }
}
}

// creategame()

// ------------------------------------------------------

var ThreeD = (function() {
	// console.log("Init Me")
	var transEndEventNames = {
			'WebkitTransition' : 'webkitTransitionEnd',
			'MozTransition' : 'transitionend',
			'OTransition' : 'oTransitionEnd',
			'msTransition' : 'MSTransitionEnd',
			'transition' : 'transitionend'
		}, 
		transEndEventName = transEndEventNames[ Modernizr.prefixed( 'transition' ) ],
		$games = $( '#bk-list > li > div.bk-game' ), gamesCount = 13, currentgame = -1, counter = 0; 
	
	function init() {
		// console.log("applying 3D!")
		
		$games.each( async function( i ) 
		// for(i=0;i<4;i++)
		{
			
			console.log("Made it")
			var $game = $( this ),
				$other = $games.not( $game ),
				$parent = $game.parent(),
				$page = $game.children( 'div.bk-page' ),
				$content = $page.children( 'div.bk-content' ), current = 0;
			
			if (counter === 13){
				counter = 0;
			}
			console.log(gamesCount)
			if( i < gamesCount / 2 ) {
				console.log("Z-index!")
				$parent.css( 'z-index', i).attr( 'data-stackval', i );
				counter ++;
			
			}
			else {
				$parent.css( 'z-index', gamesCount - 1 - i ).attr( 'data-stackval', gamesCount - 1 - i );
				counter ++;	
			}

			$game.on( 'click', function() {
				
				if( currentgame !== -1 && currentgame !== $parent.index() ) {
					closeCurrent();
				}
				
				if( $game.data( 'opened' ) ) {
					$game.data( 'opened', false ).removeClass( 'bk-viewinside' ).on( transEndEventName, function() {
						$( this ).off( transEndEventName ).removeClass( 'bk-outside' );
						$parent.css( 'z-index', $parent.data( 'stackval' ) );
						currentgame = -1;
					} );
				}
				else {
					$game.data( 'opened', true ).addClass( 'bk-outside' ).on( transEndEventName, function() {
						$( this ).off( transEndEventName ).addClass( 'bk-viewinside' );  
						$parent.css( 'z-index', gamesCount );
						currentgame = $parent.index();
					} );
					current = 0;
					$content.removeClass( 'bk-content-current' ).eq( current ).addClass( 'bk-content-current' );
				}

			} );

			if( $content.length > 1 ) {

				var $navPrev = $( '<span class="bk-page-prev">&lt;</span>' ),
					$navNext = $( '<span class="bk-page-next">&gt;</span>' );
				
				$page.append( $( '<nav></nav>' ).append( $navPrev, $navNext ) );

				$navPrev.on( 'click', function() {
					if( current > 0 ) {
						--current;
						$content.removeClass( 'bk-content-current' ).eq( current ).addClass( 'bk-content-current' );
					}
					return false;
				} );

				$navNext.on( 'click', function() {
					if( current < $content.length - 1 ) {
						++current;
						$content.removeClass( 'bk-content-current' ).eq( current ).addClass( 'bk-content-current' );
					}
					return false;
				} );

			}
			
		} );

	}

	function closeCurrent() {

		var $game = $games.eq( currentgame ),
			$parent = $game.parent();
		
		$game.data( 'opened', false ).removeClass( 'bk-viewinside' ).on( transEndEventName, function(e) {
			$( this ).off( transEndEventName ).removeClass( 'bk-outside' );
			$parent.css( 'z-index', $parent.attr( 'data-stackval' ) );
		} );

	}

	return { init : init };

})();

// Games.init();

